парсер-агрегатор вебкамов.

источники данных:
bongacams.com
	GET https://bngpt.com/promo.php?c=288541&type=api&api_v=1&api_type=json&lang=en&limit='.$limit
	XMLHttpRequest GET https://bongacams.com/tools/listing_v3.php?livetab='.$gender.'&online_only=true&limit='.$limit.'&offset='.$offset.'&category='.$cat.'&tag='.$tag; +часть запроса в куках
	POST https://en.bongacams.com/tools/amf.php {method=getRoomData&args%5B%5D='.$model_name.'&args%5B%5D=true}
	XMLHttpRequest GET https://ua.bongacams.com/chat-profile/Elizaveca?_=1598444666821

stripchat.com
	GET https://stripchat.com/api/front/models?limit='.$limit
	GET https://stripchat.com/api/front/models?limit='.$limit.'&primaryTag=men
	GET https://stripchat.com/api/front/models?limit='.$limit.'&primaryTag=trans
	GET https://go.schjmp.com/api/models/?applyGeobans=0&limit='.$limit.'&strict=1
	GET https://stripchat.com/api/front/v2/models/username/'.$model_name.'/cam

chaturbate.com
	GET https://chaturbate.com/affiliates/api/onlinerooms/?format=json&wm=t5DK7
	GET https://chaturbate.com/api/biocontext/'.$model_name.'/
	GET https://chaturbate.com/api/panel_context/'.$model_name.'/

на выходе:
общий для всех api,
проксификатор пикчей

основные свойства модели в выходном апи:
id
	//локальный айди модели уникальное значение
id_ext
	//айди модели на её платформе, как есть, неуникальное значение, массив числовых значений(одна модель может присутствовать в нескольких сервисах)
статус
	//"public", "private", "group"
username
	//используется для отображения на страницах и в урле(https://site.com/cam/{%username%}/)
display_name
	//в bongacams это поле display_name, может пригодиться
платформа
	//из какого сервиса модель, массив числовых значений(одна модель может присутствовать в нескольких сервисах)
рейтинг
	//локальное уникальное значение, в явном виде есть только в stripchat, для остальных нужно вычислять из других данных и нормализовать так чтобы модели всех сервисов были равномерно распределены по всему диапазону рейтинга, чтоб при сортировке по этому полю не было например только чатурбейта
новая
	//модель новая (2 недели с момента регистрации)
пол
	//female, male, couple, tranny, females, maleFemale, males, trannies, maleTranny, femaleTranny
возраст
	//
дата рождения
	//
язык
	//
дополнительные языки
	//массив значений
страна
	//
скрытые регионы
	//регионы для которых модель не видно
этничность
	//
внешность
	//все данные касающиеся внешности, некоторые данные индивидуальные для полов
категория
	//не уверен нужно ли
теги
	//все теги, есть специфичные для пола, скорей всего категории на сайтах будут формироваться на основе этих данных, возможно в целях оптимизации целесообразно отсортировать их на основные и второстепенные
описание стрима
	//текстовые данные из topic,goal,room_subject
дата регистрации
	//
аватар
	//постоянная картинка из профиля модели
превью
	//массив значений, в первом ключе моментальный снимок стрима если есть
время стрима
	//время с начала трансляции
количество смотрящих
	//
качество стрима
	//числовое значение, HD/HD+/no_HD/...
Mobile
	//трансляция идет с мобилы
InteractiveToy
	//пользователи могут управлять интерактивной игрушкой модели
url стрима
	//ссылка на .m3u8
параметры стрима
	//битрейт, ширина и высота стрима
дополнительные свойства
	//различные данные из профиля модели, все остальное что может представлять практическое значение


хранилище данных:
таблица(таблицы) для динамических данных обновляемая раз в минуту(статус, количество смотрящих, параметры стрима и.т.д.).
таблица(таблицы) для статических данных обновляемая например раз в неделю(пол, дата рождения, внешность и.т.д.).
статические данные используются если модель не онлайн, но на её страницу зашел пользователь или гугл.
таблица(таблицы) для данных вносимых локально, например СЕО текст.
базу экономим, минимизируем данные где это возможно, например вместо полных урлов к картинкам можно хранить id картиночного сервера и динамическую часть урла, все данные которые можно хранить в виде id храним в виде id.

кэш:
все выборки кешируем в Memcached.

парсинг:
по крону каждую минуту,
используем прокси,
т.к. парсится не один источник и возможны задержки, или неполучение данных, нужно предусмотреть работу скрипта на последних удачно полученных данных.
многие модели имеют аккаунты в нескольких сервисах, нужно предусмотреть объединение таких профилей в один при совпадении нескольких полей, например username+возраст, если совпадает только username, то в базу заносятся оба профиля с пометкой "дубль" для последующей ручной проверки, дублирующий заносится как _username.
что парсить, как парсить и когда парсить придётся смотреть в консоли браузера, что будет непонятно, я подскажу.
у стрипчата есть небольшая дока по одному из апи, при необходимости копирну из кабинета.

картинки:
у каждого сервиса есть по несколько вариантов превью, отдаются с разных серверов, периодически сервера падают и вместо картинки бывает дырка, нужно собрать все возможные варианты где брать картинку,
посетителям картинка отдается с моего домена, урл картинки формируется в браузере, например https://site.com/img/'+username+'.webp, при обращении скрипт пытается получить файл моментального снимка с сервиса, если попытка неудачная, то пробует следующий вариант, если все итерации неудачны, то отдается заглушка,
если картинка получена, то она ресайзится, конвертируется в .webp, кешируется в Memcached на несколько минут и выводится в браузер.
исходные картинки могут быть любых размеров, на выходе они должны иметь одинаковый размер, если исходная картинка вертикальная(с мобилы) добавляем к ней недостающее пространство по бокам, смысл здесь в сокращении вычислений в css и ускорении рендера страницы.

по чатурбейту забыл уточнить, у них в апи нет ссылки на моментальный снапшот
ссылка формируется так:
https://cbjpeg.stream.highwebmedia.com/minifap/" + username + ".jpg,

админка:
возможность вкючить/выключить определенный сервис;
возможность настраивать сопоставление полей внешних данных с полями заносимыми в базу;
возможность настраивать выборку определенных данных по конкретному GET запросу, например для формирования кастомных разделов на сайте, или списка конкретных моделей;
возможность отключить определенную модель;
возможность вывести определенную модель на первое место глобально, или в определенной выборке;
возможность добавления/редактирования произвольных данных для произвольной модели;

оптимизация:
минимум вычислений на стороне клиента, при этом не кладем сервак на лопатки.
сервер должен отдать некешированные данные не более чем за 0.01 сек. и кешированные не более чем за 0.002 сек.(тестил свой индийский код).
для каждого запроса отдаем только то что будет использовано(настраивается в админке), в максимально простом для рендера виде.

код:
без фреймворков,
краткие комментарии к функциям,
предусмотреть дальнейшую модернизацию и прикручивание других вебкам-сервисов,
не оставляем в коде удобных мест для коллег с ачата.

примерная структура:
/admin/	//админка;
/api/	//выходной апи;
/functions/	//система;
/img/	//проксификатор пикчей;
/parsers/	//файлы парсеров, для каждого источника отдельный (bongacams.php, stripchat.php, chaturbate.php);
/index.php	//тестовая морда;
/cat.php	//тестовая категория;
/subcat.php	//тестовая вложенная категория;
/gender.php	//тестовый раздел для полов;

на что смотреть:
https://cam4joy.com/
https://www.freecamstars.com/
https://cambb.xxx/

ТЗ не строгое, креатив и лучшие решения приветствуются и обсуждаются
